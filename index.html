<!DOCTYPE html>
<html lang="pt-br">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Estação da Terra</title>
  <link rel="stylesheet" href="style.css" />
  <!-- VLibras script -->
  <script src="https://vlibras.gov.br/app/vlibras-plugin.js" defer></script>
</head>
<body>

  <!-- VLibras -->
  <div vw class="enabled">
    <div vw-access-button class="active"></div>
    <div vw-plugin-wrapper>
      <div class="vw-plugin-top-wrapper"></div>
    </div>
  </div>

  <!-- Cabeçalho -->
  <header>
    <h1>Estação da Terra</h1>
    <p class="slogan">Do campo à cidade, colhendo oportunidades</p>
    <nav class="menu" aria-label="Menu principal">
      <ul>
        <li><button class="menu-btn" id="btn-loja" aria-controls="sec-loja" aria-expanded="true">Loja</button></li>
        <li><button class="menu-btn" id="btn-contato" aria-controls="sec-contato" aria-expanded="false">Contato</button></li>
        <li><a href="quiz.html" class="menu-link">Quiz</a></li>
        <li><a href="sobre.html" class="menu-link">Sobre</a></li>
      </ul>
    </nav>
  </header>

  <main>
    <!-- Seção Loja -->
    <section class="produtos" id="sec-loja" tabindex="-1" aria-label="Seção da loja com produtos">
      <h2>Produtos à Venda</h2>
      <div class="barracas">

        <article class="produto-card" tabindex="0">
          <img src="imagens/maca.jpg" alt="Maçã Orgânica" />
          <h3>Maçã Orgânica</h3>
          <p>R$ 3,00/kg</p>
          <button onclick="adicionarAoCarrinho('Maçã Orgânica', 3)">Adicionar</button>
        </article>

        <article class="produto-card" tabindex="0">
          <img src="imagens/mel.jpg" alt="Mel Puro" />
          <h3>Mel Puro</h3>
          <p>R$ 15,00</p>
          <button onclick="adicionarAoCarrinho('Mel Puro', 15)">Adicionar</button>
        </article>

        <article class="produto-card" tabindex="0">
          <img src="imagens/queijo.jpg" alt="Queijo Artesanal" />
          <h3>Queijo Artesanal</h3>
          <p>R$ 25,00</p>
          <button onclick="adicionarAoCarrinho('Queijo Artesanal', 25)">Adicionar</button>
        </article>

        <!-- Novos produtos -->
        <article class="produto-card" tabindex="0">
          <img src="imagens/azeite.jpg" alt="Azeite de Oliva" />
          <h3>Azeite de Oliva</h3>
          <p>R$ 40,00</p>
          <button onclick="adicionarAoCarrinho('Azeite de Oliva', 40)">Adicionar</button>
        </article>

        <article class="produto-card" tabindex="0">
          <img src="imagens/banana.jpg" alt="Banana Orgânica" />
          <h3>Banana Orgânica</h3>
          <p>R$ 2,50/kg</p>
          <button onclick="adicionarAoCarrinho('Banana Orgânica', 2.5)">Adicionar</button>
        </article>

        <!-- Você pode adicionar mais produtos aqui -->

      </div>
    </section>

    <!-- Seção Contato -->
    <section id="sec-contato" tabindex="-1" aria-label="Seção de contato" hidden>
      <h2>Contato</h2>
      <form id="form-contato">
        <label for="nome">Nome:</label>
        <input type="text" id="nome" name="nome" required />

        <label for="email">Email:</label>
        <input type="email" id="email" name="email" required />

        <label for="mensagem">Mensagem:</label>
        <textarea id="mensagem" name="mensagem" rows="4" required></textarea>

        <button type="submit">Enviar</button>
      </form>
    </section>

    <!-- Carrinho -->
    <section class="carrinho" aria-label="Carrinho de Compras">
      <h2>Carrinho</h2>
      <ul id="lista-carrinho" aria-live="polite" aria-relevant="additions removals"></ul>
      <p id="total-carrinho">Total: R$ 0,00</p>
      <button id="btn-finalizar" onclick="mostrarAreaPagamento()" disabled>Finalizar Compra</button>
      <button id="btn-limpar" onclick="limparCarrinho()" disabled>Limpar Carrinho</button>
    </section>

    <!-- Área de Pagamento -->
    <section class="pagamento" id="area-pagamento" style="display:none;">
      <h2>Pagamento</h2>
      <form id="form-pagamento" onsubmit="finalizarCompra(event)">
        <label for="nome-pagamento">Nome Completo:</label>
        <input type="text" id="nome-pagamento" name="nome-pagamento" required />

        <label for="cartao">Número do Cartão:</label>
        <input type="text" id="cartao" name="cartao" pattern="\d{16}" maxlength="16" placeholder="0000 0000 0000 0000" required />

        <label for="validade">Validade:</label>
        <input type="month" id="validade" name="validade" required />

        <label for="cvv">CVV:</label>
        <input type="password" id="cvv" name="cvv" pattern="\d{3}" maxlength="3" required />

        <button type="submit">Pagar</button>
        <button type="button" onclick="voltarAoCarrinho()">Voltar ao Carrinho</button>
      </form>
    </section>
  </main>

  <script>
    // VLibras plugin init
    window.addEventListener('load', () => {
      new window.VLibras.Widget('https://vlibras.gov.br/app');
    });

    // Menu: alternar entre Loja e Contato
    const btnLoja = document.getElementById('btn-loja');
    const btnContato = document.getElementById('btn-contato');
    const secLoja = document.getElementById('sec-loja');
    const secContato = document.getElementById('sec-contato');

    function mostrarSecao(secMostrar, secEsconder, btnAtivo, btnInativo) {
      secMostrar.hidden = false;
      secEsconder.hidden = true;
      btnAtivo.setAttribute('aria-expanded', 'true');
      btnInativo.setAttribute('aria-expanded', 'false');
      secMostrar.focus();
    }

    btnLoja.addEventListener('click', () => {
      mostrarSecao(secLoja, secContato, btnLoja, btnContato);
    });

    btnContato.addEventListener('click', () => {
      mostrarSecao(secContato, secLoja, btnContato, btnLoja);
    });

    // Carrinho
    let carrinho = [];

    function adicionarAoCarrinho(nome, preco) {
      const itemExistente = carrinho.find(item => item.nome === nome);
      if (itemExistente) {
        itemExistente.quantidade++;
      } else {
        carrinho.push({ nome, preco, quantidade: 1 });
      }
      atualizarCarrinho();
    }

    function atualizarCarrinho() {
      const lista = document.getElementById('lista-carrinho');
      lista.innerHTML = '';

      let total = 0;
      carrinho.forEach((item, index) => {
        total += item.preco * item.quantidade;

        const li = document.createElement('li');
        li.textContent = `${item.nome} - R$ ${item.preco.toFixed(2)} x ${item.quantidade}`;

        const btnRemover = document.createElement('button');
        btnRemover.textContent = 'Remover';
        btnRemover.setAttribute('aria-label', `Remover ${item.nome} do carrinho`);
        btnRemover.onclick = () => {
          removerDoCarrinho(index);
        };
        li.appendChild(btnRemover);
        lista.appendChild(li);
      });

      document.getElementById('total-carrinho').textContent = `Total: R$ ${total.toFixed(2)}`;

      document.getElementById('btn-finalizar').disabled = carrinho.length === 0;
      document.getElementById('btn-limpar').disabled = carrinho.length === 0;
    }

    function removerDoCarrinho(index) {
      carrinho.splice(index, 1);
      atualizarCarrinho();
    }

    function limparCarrinho() {
      if (confirm('Deseja realmente limpar o carrinho?')) {
        carrinho = [];
        atualizarCarrinho();
      }
    }

    function mostrarAreaPagamento() {
      document.querySelector('.produtos').style.display = 'none';
      document.querySelector('.carrinho').style.display = 'none';
      document.getElementById('area-pagamento').style.display = 'block';
      window.scrollTo(0, 0);
    }

    function voltarAoCarrinho() {
      document.querySelector('.produtos').style.display = 'block';
      document.querySelector('.carrinho').style.display = 'block';
      document.getElementById('area-pagamento').style.display = 'none';
      window.scrollTo(0, 0);
    }

    function finalizarCompra(event) {
      event.preventDefault();

      const nome = document.getElementById('nome-pagamento').value.trim();
      if (carrinho.length === 0) {
        alert('Seu carrinho está vazio.');
        voltarAoCarrinho();
        return;
      }
      alert(`Obrigado pela compra, ${nome}!\nTotal: R$ ${carrinho.reduce((acc, item) => acc + item.preco * item.quantidade, 0).toFixed(2)}`);

      // Resetar tudo
      carrinho = [];
      atualizarCarrinho();
      document.getElementById('form-pagamento').reset();
      voltarAoCarrinho();
    }

    // Inicializa o carrinho vazio
    atualizarCarrinho();

    // Form contato - só exibe alerta
    document.getElementById('form-contato').addEventListener('submit', function (e) {
      e.preventDefault();
      alert('Mensagem enviada! Obrigado pelo contato.');
      this.reset();
    });
  </script>

</body>
</html>
