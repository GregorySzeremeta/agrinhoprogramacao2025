<!DOCTYPE html>
<html lang="pt-br">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>Esta√ß√£o da Terra - Produtos do Campo</title>
<link rel="stylesheet" href="style.css" />
<!-- LIBRAS CDN -->
<script src="https://vlibras.gov.br/app/vlibras-plugin.js"></script>
</head>
<body>
<!-- Plugin VLibras -->
<div vw class="enabled">
  <div vw-access-button class="active"></div>
  <div vw-plugin-wrapper>
    <div class="vw-plugin-top-wrapper"></div>
  </div>
</div>

<header>
  <h1>Esta√ß√£o da Terra</h1>
  <p class="slogan">Do campo √† cidade, colhendo oportunidades</p>
  <nav>
    <button class="nav-btn" data-target="loja">Loja</button>
    <button class="nav-btn" data-target="quiz">Quiz do Campo</button>
    <button class="nav-btn" id="btn-som">Som Ambiente</button>
  </nav>
  <div id="cart-icon" tabindex="0" aria-label="Carrinho de compras com 0 itens">
    üõí<span id="cart-count">0</span>
  </div>
</header>

<main>
  <!-- Se√ß√£o Loja -->
  <section id="loja" class="active" aria-live="polite" tabindex="0">
    <h2>Produtos do Campo</h2>
    <div id="produtos" class="produtos-grid" role="list"></div>
  </section>

  <!-- Se√ß√£o Carrinho -->
  <section id="carrinho" aria-live="polite" tabindex="0" hidden>
    <h2>Seu Carrinho</h2>
    <ul id="lista-carrinho" role="list"></ul>
    <div class="total">
      <strong>Total: R$ <span id="total-preco">0,00</span></strong>
    </div>
    <button id="finalizar-compra" class="btn-primary">Finalizar Compra</button>
    <button id="voltar-loja" class="btn-secondary">Voltar √† Loja</button>
  </section>

  <!-- Se√ß√£o Quiz -->
  <section id="quiz" aria-live="polite" tabindex="0" hidden>
    <h2>Quiz: Voc√™ conhece a produ√ß√£o do campo?</h2>
    <form id="quiz-form" aria-label="Quiz sobre produ√ß√£o do campo">
      <div id="perguntas-container"></div>
      <button type="submit" class="btn-primary">Enviar Respostas</button>
    </form>
    <div id="resultado" hidden>
      <h3>Resultado: <span id="pontuacao"></span>% de acertos</h3>
      <button id="refazer-quiz" class="btn-secondary">Refazer Quiz</button>
    </div>
  </section>
</main>

<!-- √Åudio Som Ambiente -->
<audio id="audio-som" loop src="https://cdn.pixabay.com/download/audio/2022/03/28/audio_49d21727f3.mp3?filename=forest-ambience-6991.mp3"></audio>

<!-- Confete Container -->
<div id="confete-container"></div>

<script>
// Produtos (30 produtos + categorias)
const produtos = [
  { id:1, nome:"Tomate Org√¢nico", preco:4.5, categoria:"Verduras" },
  { id:2, nome:"Alface Crespa", preco:3.0, categoria:"Verduras" },
  { id:3, nome:"Cenoura", preco:2.8, categoria:"Verduras" },
  { id:4, nome:"Batata Doce", preco:5.0, categoria:"Verduras" },
  { id:5, nome:"Ma√ß√£ Fuji", preco:7.0, categoria:"Frutas" },
  { id:6, nome:"Banana Nanica", preco:4.2, categoria:"Frutas" },
  { id:7, nome:"Laranja Pera", preco:3.8, categoria:"Frutas" },
  { id:8, nome:"Mel√£o", preco:6.0, categoria:"Frutas" },
  { id:9, nome:"Leite Integral", preco:5.5, categoria:"Latic√≠nios" },
  { id:10, nome:"Queijo Minas", preco:15.0, categoria:"Latic√≠nios" },
  { id:11, nome:"Manteiga Artesanal", preco:12.0, categoria:"Latic√≠nios" },
  { id:12, nome:"Mel de Abelha", preco:20.0, categoria:"Mel" },
  { id:13, nome:"Ovos Caipiras (12 un)", preco:8.0, categoria:"Derivados" },
  { id:14, nome:"Arroz Integral", preco:10.0, categoria:"Gr√£os" },
  { id:15, nome:"Feij√£o Preto", preco:9.0, categoria:"Gr√£os" },
  { id:16, nome:"Farinha de Mandioca", preco:7.5, categoria:"Gr√£os" },
  { id:17, nome:"Pimenta do Reino", preco:18.0, categoria:"Especiarias" },
  { id:18, nome:"Ch√° de Erva Mate", preco:6.0, categoria:"Bebidas" },
  { id:19, nome:"Caf√© Torrado", preco:25.0, categoria:"Bebidas" },
  { id:20, nome:"Sucos Naturais", preco:7.0, categoria:"Bebidas" },
  { id:21, nome:"Ab√≥bora", preco:3.0, categoria:"Verduras" },
  { id:22, nome:"Cebola", preco:2.5, categoria:"Verduras" },
  { id:23, nome:"Alho", preco:6.0, categoria:"Verduras" },
  { id:24, nome:"Coco Verde", preco:4.0, categoria:"Frutas" },
  { id:25, nome:"Amendoim Torrado", preco:8.0, categoria:"Gr√£os" },
  { id:26, nome:"Farinha de Trigo Integral", preco:6.0, categoria:"Gr√£os" },
  { id:27, nome:"Iogurte Natural", preco:5.5, categoria:"Latic√≠nios" },
  { id:28, nome:"Requeij√£o Cremoso", preco:12.0, categoria:"Latic√≠nios" },
  { id:29, nome:"Suco de Laranja", preco:7.0, categoria:"Bebidas" },
  { id:30, nome:"Azeite de Oliva", preco:30.0, categoria:"Derivados" }
];

// Vari√°veis Globais
let carrinho = [];

// Fun√ß√£o para mostrar produtos na loja
function mostrarProdutos() {
  const container = document.getElementById('produtos');
  container.innerHTML = '';
  const categorias = [...new Set(produtos.map(p => p.categoria))].sort();
  categorias.forEach(cat => {
    const catTitle = document.createElement('h3');
    catTitle.textContent = cat;
    container.appendChild(catTitle);
    const catGrid = document.createElement('div');
    catGrid.className = 'produtos-categoria';
    produtos.filter(p => p.categoria === cat).forEach(prod => {
      const card = document.createElement('div');
      card.className = 'produto-card';
      card.setAttribute('role', 'listitem');
      card.innerHTML = `
        <strong>${prod.nome}</strong>
        <p>R$ ${prod.preco.toFixed(2).replace('.', ',')}</p>
        <button class="btn-add" aria-label="Adicionar ${prod.nome} ao carrinho" data-id="${prod.id}">Adicionar</button>
      `;
      catGrid.appendChild(card);
    });
    container.appendChild(catGrid);
  });
}

// Atualizar carrinho
function atualizarCarrinho() {
  const lista = document.getElementById('lista-carrinho');
  const count = document.getElementById('cart-count');
  const totalPreco = document.getElementById('total-preco');
  lista.innerHTML = '';

  if (carrinho.length === 0) {
    lista.innerHTML = '<li>Seu carrinho est√° vazio.</li>';
    totalPreco.textContent = '0,00';
    count.textContent = '0';
    document.getElementById('cart-icon').setAttribute('aria-label', 'Carrinho de compras com 0 itens');
    return;
  }

  let total = 0;
  carrinho.forEach(item => {
    const prod = produtos.find(p => p.id === item.id);
    const li = document.createElement('li');
    li.textContent = `${prod.nome} - R$ ${prod.preco.toFixed(2).replace('.', ',')} (Quantidade: ${item.quantidade})`;
    lista.appendChild(li);
    total += prod.preco * item.quantidade;
  });
  totalPreco.textContent = total.toFixed(2).replace('.', ',');
  count.textContent = carrinho.reduce((acc, i) => acc + i.quantidade, 0);
  document.getElementById('cart-icon').setAttribute('aria-label', `Carrinho de compras com ${count.textContent} itens`);
}

// Adicionar produto no carrinho
function adicionarAoCarrinho(id) {
  const itemIndex = carrinho.findIndex(i => i.id === id);
  if (itemIndex >= 0) {
    carrinho[itemIndex].quantidade++;
  } else {
    carrinho.push({ id, quantidade: 1 });
  }
  atualizarCarrinho();
}

// Alternar se√ß√µes do site
function mostrarSecao(secao) {
  ['loja', 'carrinho', 'quiz'].forEach(id => {
    document.getElementById(id).hidden = (id !== secao);
    document.getElementById(id).classList.toggle('active', id === secao);
  });
}

// Eventos de navega√ß√£o
document.querySelectorAll('.nav-btn').forEach(btn => {
  btn.addEventListener('click', () => {
    if (btn.id === 'btn-som') {
      toggleSom();
      return;
    }
    mostrarSecao(btn.dataset.target);
  });
});

// √çcone carrinho
document.getElementById('cart-icon').addEventListener('click', () => {
  mostrarSecao('carrinho');
});

// Bot√µes dentro do carrinho
document.getElementById('voltar-loja').addEventListener('click', () => {
  mostrarSecao('loja');
});
document.getElementById('finalizar-compra').addEventListener('click', () => {
  alert('Compra finalizada com sucesso! Obrigado por comprar na Esta√ß√£o da Terra üå±');
  carrinho = [];
  atualizarCarrinho();
  mostrarSecao('loja');
});

// Bot√µes Adicionar produtos
document.addEventListener('click', e => {
  if (e.target.classList.contains('btn-add')) {
    const id = Number(e.target.dataset.id);
    adicionarAoCarrinho(id);
  }
});

// Som Ambiente
const audioSom = document.getElementById('audio-som');
let somTocado = false;
function toggleSom() {
  if (somTocado) {
    audioSom.pause();
    somTocado = false;
    document.getElementById('btn-som').textContent = 'Som Ambiente';
  } else {
    audioSom.play();
    somTocado = true;
    document.getElementById('btn-som').textContent = 'Parar Som';
  }
}

// Quiz com 10 perguntas + 7 extras = 17 perguntas totais
const perguntasQuiz = [
  { q:"Qual √© a principal cultura do Brasil?", options:["Soja","Milho","Cana-de-a√ß√∫car","Arroz"], answer:2 },
  { q:"O que √© agricultura org√¢nica?", options:["Uso de agrot√≥xicos","Produ√ß√£o sem qu√≠micos sint√©ticos","S√≥ planta flores","Uso de sementes transg√™nicas"], answer:1 },
  { q:"Qual animal produz leite na fazenda?", options:["Porco","Vaca","Cavalo","Galinha"], answer:1 },
  { q:"Qual gr√£o √© usado para fazer p√£o?", options:["Arroz","Milho","Trigo","Feij√£o"], answer:2 },
  { q:"O que significa irriga√ß√£o?", options:["Plantar sementes","Molhar plantas","Colher frutas","Adubar solo"], answer:1 },
  { q:"Qual destes √© um legume?", options:["Tomate","Ma√ß√£","Banana","Abacaxi"], answer:0 },
  { q:"O que √© compostagem?", options:["Queimar lixo","Transformar res√≠duos em adubo","Plantar √°rvores","Construir estufas"], answer:1 },
  { q:"O que √© plantio direto?", options:["Sem revolver a terra","Usar pesticidas","Colher frutas","Criar animais"], answer:0 },
  { q:"Qual √© a import√¢ncia das abelhas?", options:["Produzir mel","Polinizar plantas","Ser alimento","Fazer roupas"], answer:1 },
  { q:"O que √© agricultura sustent√°vel?", options:["Destruir florestas","Preservar o meio ambiente","Usar s√≥ m√°quinas","Plantar s√≥ soja"], answer:1 },
  // Perguntas extras:
  { q:"O que √© rota√ß√£o de culturas?", options:["Plantio alternado para conservar solo","Plantar uma cultura s√≥","Uso de m√°quinas","Colheita manual"], answer:0 },
  { q:"Qual a vantagem da agroecologia?", options:["Uso de qu√≠micos fortes","Preserva√ß√£o da biodiversidade","Acelerar produ√ß√£o","Menor qualidade"], answer:1 },
  { q:"O que √© adubo org√¢nico?", options:["Fertilizante natural","Produto qu√≠mico","Inseticida","Herbicida"], answer:0 },
  { q:"Qual √© o principal benef√≠cio da √°gua na agricultura?", options:["Irriga√ß√£o das plantas","Limpeza do solo","Pintura","Constru√ß√£o"], answer:0 },
  { q:"O que s√£o sementes crioulas?", options:["Sementes modificadas","Sementes tradicionais locais","Sementes sint√©ticas","Sementes importadas"], answer:1 },
  { q:"Por que o solo √© importante?", options:["Nada importante","Suporte para plantas","Para constru√ß√£o","Para animais"], answer:1 },
  { q:"O que √© agroflorestal?", options:["Combina√ß√£o de agricultura e floresta","Uso s√≥ de m√°quinas","Plantar s√≥ √°rvores","Criar s√≥ animais"], answer:0 }
];

// Construir perguntas no quiz
const containerQuiz = document.getElementById('perguntas-container');
function montarQuiz() {
  containerQuiz.innerHTML = '';
  perguntasQuiz.forEach((p, i) => {
    const div = document.createElement('div');
    div.className = 'pergunta';
    div.innerHTML = `
      <fieldset>
        <legend>${i+1}. ${p.q}</legend>
        ${p.options.map((opt,j) => `
          <label>
            <input type="radio" name="pergunta${i}" value="${j}" required />
            ${opt}
          </label>
        `).join('')}
      </fieldset>
    `;
    containerQuiz.appendChild(div);
  });
}
montarQuiz();

// Confete animation
function soltarConfete() {
  const confeteContainer = document.getElementById('confete-container');
  confeteContainer.innerHTML = '';
  const colors = ['#FFC700', '#FF0000', '#2E3192', '#41BBC7', '#732982'];
  for (let i = 0; i < 150; i++) {
    const confete = document.createElement('div');
    confete.classList.add('confete');
    confete.style.backgroundColor = colors[Math.floor(Math.random() * colors.length)];
    confete.style.left = Math.random() * 100 + 'vw';
    confete.style.animationDelay = Math.random() * 3 + 's';
    confeteContainer.appendChild(confete);
  }
  setTimeout(() => { confeteContainer.innerHTML = ''; }, 5000);
}

// Enviar quiz
document.getElementById('quiz-form').addEventListener('submit', e => {
  e.preventDefault();
  const respostas = [];
  let acertou = 0;
  perguntasQuiz.forEach((p, i) => {
    const val = document.querySelector(`input[name="pergunta${i}"]:checked`);
    if (val && parseInt(val.value) === p.answer) acertou++;
  });
  const percentual = Math.round((acertou / perguntasQuiz.length) * 100);
  document.getElementById('pontuacao').textContent = percentual;
  document.getElementById('resultado').hidden = false;
  soltarConfete();
  // Scroll para resultado
  document.getElementById('resultado').focus();
  // Oculta quiz e formul√°rio
  document.getElementById('quiz-form').hidden = true;
});

// Refazer quiz
document.getElementById('refazer-quiz').addEventListener('click', () => {
  document.getElementById('resultado').hidden = true;
  document.getElementById('quiz-form').hidden = false;
  document.getElementById('quiz-form').reset();
  containerQuiz.focus();
});

// Inicializa√ß√£o
mostrarProdutos();
atualizarCarrinho();

// Inicializar VLibras
window.onload = function() {
  new window.VLibras.Widget('vlibras-plugin');
};
</script>

</body>
</html>
