<!DOCTYPE html>
<html lang="pt-BR">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>EstaÃ§Ã£o da Terra - Loja</title>
<link rel="stylesheet" href="style.css" />
</head>
<body>

<header>
  <h1>EstaÃ§Ã£o da Terra</h1>
  <nav>
    <button id="btnAumentarFonte" aria-label="Aumentar fonte">A+</button>
    <button id="btnDiminuirFonte" aria-label="Diminuir fonte">A-</button>
    <button id="btnContraste" aria-label="Ativar/desativar contraste">Contraste</button>
    <button id="btnSom" aria-label="Ligar ou desligar som ambiente">ðŸ”Š Som</button>
    <button id="btnLibras" aria-label="Ativar traduÃ§Ã£o em Libras">ðŸ¤Ÿ LIBRAS</button>
  </nav>
</header>

<main>
  <section aria-label="Produtos disponÃ­veis" id="produtos">
    <h2>Produtos do Campo</h2>
    <div class="produtos-lista" id="produtos-lista">
      <!-- Produtos serÃ£o inseridos via JS -->
    </div>
  </section>

  <aside aria-label="Carrinho de compras" id="carrinho" tabindex="0">
    <h2>Seu Carrinho</h2>
    <ul id="lista-carrinho" aria-live="polite" aria-relevant="additions removals"></ul>
    <p id="total-carrinho">Total: R$ 0,00</p>
    <button id="btnFinalizarCompra" disabled>Finalizar Compra</button>
    <button id="btnEsvaziarCarrinho" disabled>Esvaziar Carrinho</button>
  </aside>
</main>

<!-- Video LIBRAS oculto inicialmente -->
<div id="videoLibrasContainer" aria-hidden="true" hidden>
  <button id="btnFecharLibras" aria-label="Fechar vÃ­deo LIBRAS">âœ–</button>
  <video width="320" height="240" controls>
    <source src="https://www.signingsavvy.com/media/videos/3387.mp4" type="video/mp4" />
    Seu navegador nÃ£o suporta vÃ­deo.
  </video>
</div>

<audio id="somAmbiente" loop>
  <source src="https://cdn.pixabay.com/download/audio/2022/03/24/audio_b64a1e1e10.mp3?filename=relaxing-nature-ambient-11249.mp3" type="audio/mp3" />
  Seu navegador nÃ£o suporta Ã¡udio.
</audio>

<script>
  // Produtos disponÃ­veis
  const produtos = [
    {id:1, nome:"Leite Integral", categoria:"Leite", preco:5.90},
    {id:2, nome:"Queijo Minas", categoria:"Queijos", preco:25.00},
    {id:3, nome:"Mel Puro", categoria:"Mel", preco:30.00},
    {id:4, nome:"Arroz OrgÃ¢nico", categoria:"GrÃ£os", preco:12.50},
    {id:5, nome:"FeijÃ£o Preto", categoria:"GrÃ£os", preco:8.90},
    {id:6, nome:"Alface Crespa", categoria:"Verduras", preco:3.20},
    {id:7, nome:"Tomate", categoria:"Frutas", preco:4.50},
    {id:8, nome:"Batata Doce", categoria:"Verduras", preco:6.00},
    {id:9, nome:"Sementes de Girassol", categoria:"Sementes", preco:15.00},
    {id:10, nome:"Morango OrgÃ¢nico", categoria:"Frutas", preco:18.00},

    // 10 produtos adicionais
    {id:11, nome:"Cenoura OrgÃ¢nica", categoria:"Verduras", preco:5.00},
    {id:12, nome:"Couve-Flor", categoria:"Verduras", preco:7.50},
    {id:13, nome:"Leite de Cabra", categoria:"Leite", preco:9.00},
    {id:14, nome:"Manteiga Artesanal", categoria:"LaticÃ­nios", preco:20.00},
    {id:15, nome:"PÃ£o Integral", categoria:"Padaria", preco:6.50},
    {id:16, nome:"Melancia", categoria:"Frutas", preco:9.90},
    {id:17, nome:"Castanha do ParÃ¡", categoria:"GrÃ£os", preco:35.00},
    {id:18, nome:"ChÃ¡ de Ervas", categoria:"Bebidas", preco:12.00},
    {id:19, nome:"Ovos Caipira (dÃºzia)", categoria:"Ovos", preco:15.00},
    {id:20, nome:"AbÃ³bora Moranga", categoria:"Verduras", preco:4.00},
  ];

  const produtosLista = document.getElementById('produtos-lista');
  const carrinhoLista = document.getElementById('lista-carrinho');
  const totalCarrinho = document.getElementById('total-carrinho');
  const btnFinalizar = document.getElementById('btnFinalizarCompra');
  const btnEsvaziar = document.getElementById('btnEsvaziarCarrinho');
  const somAmbiente = document.getElementById('somAmbiente');
  const btnSom = document.getElementById('btnSom');
  const btnLibras = document.getElementById('btnLibras');
  const videoLibrasContainer = document.getElementById('videoLibrasContainer');
  const btnFecharLibras = document.getElementById('btnFecharLibras');

  let carrinho = [];

  // FunÃ§Ã£o para formatar preÃ§o em reais
  function formatarPreco(valor) {
    return 'R$ ' + valor.toFixed(2).replace('.', ',');
  }

  // Criar elementos de produtos na pÃ¡gina
  function mostrarProdutos() {
    produtosLista.innerHTML = '';
    produtos.forEach(produto => {
      const produtoDiv = document.createElement('div');
      produtoDiv.className = 'produto';
      produtoDiv.tabIndex = 0;
      produtoDiv.setAttribute('role','listitem');
      produtoDiv.innerHTML = `
        <h3>${produto.nome}</h3>
        <p><strong>Categoria:</strong> ${produto.categoria}</p>
        <p><strong>PreÃ§o:</strong> ${formatarPreco(produto.preco)}</p>
        <button aria-label="Adicionar ${produto.nome} ao carrinho" data-id="${produto.id}">Adicionar</button>
      `;
      produtosLista.appendChild(produtoDiv);
    });
  }

  // Atualizar carrinho na tela
  function atualizarCarrinho() {
    carrinhoLista.innerHTML = '';
    let total = 0;
    carrinho.forEach(item => {
      total += item.preco * item.quantidade;
      const li = document.createElement('li');
      li.innerHTML = `
        ${item.nome} â€” ${item.quantidade} x ${formatarPreco(item.preco)} = ${formatarPreco(item.preco * item.quantidade)}
        <button aria-label="Remover um ${item.nome} do carrinho" data-id="${item.id}">Remover</button>
      `;
      carrinhoLista.appendChild(li);
    });
    totalCarrinho.textContent = `Total: ${formatarPreco(total)}`;
    btnFinalizar.disabled = carrinho.length === 0;
    btnEsvaziar.disabled = carrinho.length === 0;
  }

  // Adicionar produto ao carrinho
  function adicionarProduto(id) {
    const produto = produtos.find(p => p.id === id);
    if (!produto) return;

    const itemCarrinho = carrinho.find(i => i.id === id);
    if (itemCarrinho) {
      itemCarrinho.quantidade++;
    } else {
      carrinho.push({...produto, quantidade: 1});
    }
    atualizarCarrinho();
  }

  // Remover produto do carrinho
  function removerProduto(id) {
    const index = carrinho.findIndex(i => i.id === id);
    if (index > -1) {
      carrinho[index].quantidade--;
      if (carrinho[index].quantidade <= 0) {
        carrinho.splice(index,1);
      }
    }
    atualizarCarrinho();
  }

  // Finalizar compra (simples alert)
  function finalizarCompra() {
    if (carrinho.length === 0) {
      alert("Seu carrinho estÃ¡ vazio.");
      return;
    }
    alert("Compra finalizada! Obrigado por comprar na EstaÃ§Ã£o da Terra.");
    carrinho = [];
    atualizarCarrinho();
  }

  // Esvaziar carrinho
  function esvaziarCarrinho() {
    if(confirm("Deseja esvaziar o carrinho?")) {
      carrinho = [];
      atualizarCarrinho();
    }
  }

  // Eventos

  // Adicionar produtos
  produtosLista.addEventListener('click', e => {
    if(e.target.tagName === 'BUTTON') {
      const id = parseInt(e.target.dataset.id);
      adicionarProduto(id);
    }
  });

  // Remover produtos
  carrinhoLista.addEventListener('click', e => {
    if(e.target.tagName === 'BUTTON') {
      const id = parseInt(e.target.dataset.id);
      removerProduto(id);
    }
  });

  btnFinalizar.addEventListener('click', finalizarCompra);
  btnEsvaziar.addEventListener('click', esvaziarCarrinho);

  // Acessibilidade - aumentar/diminuir fonte
  let tamanhoFonte = 16;
  document.getElementById('btnAumentarFonte').addEventListener('click', () => {
    if(tamanhoFonte < 24) {
      tamanhoFonte += 2;
      document.body.style.fontSize = tamanhoFonte + 'px';
    }
  });
  document.getElementById('btnDiminuirFonte').addEventListener('click', () => {
    if(tamanhoFonte > 12) {
      tamanhoFonte -= 2;
      document.body.style.fontSize = tamanhoFonte + 'px';
    }
  });

  // Contraste alto
  let contrasteAtivo = false;
  document.getElementById('btnContraste').addEventListener('click', () => {
    contrasteAtivo = !contrasteAtivo;
    if(contrasteAtivo) {
      document.body.classList.add('contraste');
    } else {
      document.body.classList.remove('contraste');
    }
  });

  // Som ambiente
  let somTocando = false;
  btnSom.addEventListener('click', () => {
    if(somTocando) {
      somAmbiente.pause();
      btnSom.textContent = "ðŸ”Š Som";
    } else {
      somAmbiente.play();
      btnSom.textContent = "ðŸ”ˆ Mutar";
    }
    somTocando = !somTocando;
  });

  // LIBRAS
  btnLibras.addEventListener('click', () => {
    if(videoLibrasContainer.hasAttribute('hidden')) {
      videoLibrasContainer.removeAttribute('hidden');
      videoLibrasContainer.setAttribute('aria-hidden', 'false');
      videoLibrasContainer.querySelector('video').play();
      btnLibras.setAttribute('aria-pressed', 'true');
      btnLibras.textContent = "âœ– Fechar LIBRAS";
    } else {
      videoLibrasContainer.setAttribute('hidden', '');
      videoLibrasContainer.setAttribute('aria-hidden', 'true');
      videoLibrasContainer.querySelector('video').pause();
      btnLibras.setAttribute('aria-pressed', 'false');
      btnLibras.textContent = "ðŸ¤Ÿ LIBRAS";
    }
  });

  btnFecharLibras.addEventListener('click', () => {
    videoLibrasContainer.setAttribute('hidden', '');
    videoLibrasContainer.setAttribute('aria-hidden', 'true');
    videoLibrasContainer.querySelector('video').pause();
    btnLibras.setAttribute('aria-pressed', 'false');
    btnLibras.textContent = "ðŸ¤Ÿ LIBRAS";
  });

  // Inicializar
  mostrarProdutos();
  atualizarCarrinho();

</script>
</body>
</html>
