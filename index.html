<!DOCTYPE html>
<html lang="pt-br">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Esta√ß√£o da Terra</title>
  <link rel="stylesheet" href="style.css" />
</head>
<body>

<header>
  <h1>Esta√ß√£o da Terra</h1>
  <nav>
    <button id="btn-contraste" aria-label="Ativar contraste alto">üåì</button>
    <button id="btn-fonte" aria-label="Aumentar fonte">A+</button>
    <button id="btn-som" aria-label="Ativar som ambiente">üîà</button>
    <button id="btn-libras" aria-label="Ativar tradu√ß√£o em LIBRAS">ü§ü LIBRAS</button>
  </nav>
</header>

<main>
  <p class="slogan">Do campo √† cidade, colhendo oportunidades</p>

  <section class="loja-grid" aria-label="Produtos da loja">
    <!-- Produtos ser√£o inseridos via JS -->
  </section>
</main>

<!-- Carrinho -->
<aside id="carrinho-container" aria-label="Carrinho de compras" aria-live="polite">
  <h2>Carrinho</h2>
  <ul id="lista-carrinho"></ul>
  <button id="btn-esvaziar">Esvaziar carrinho</button>
</aside>

<!-- V√≠deo LIBRAS -->
<div id="video-libras" aria-hidden="true">
  <video src="https://interactive-examples.mdn.mozilla.net/media/examples/sintel.webm" controls></video>
</div>

<!-- Anima√ß√£o √°rvore -->
<div id="animacao-arvore" aria-hidden="true">
  <div id="arvore">
    <div id="tronco"></div>
  </div>
</div>

<script>
  // Produtos da loja - array de objetos
  const produtos = [
    { id: 1, nome: "Leite Fresco", descricao: "Leite org√¢nico direto da fazenda.", preco: 8.99, img: "https://images.unsplash.com/photo-1585042595113-43dff97cd14a?auto=format&fit=crop&w=400&q=80" },
    { id: 2, nome: "Mel Puro", descricao: "Mel natural e puro, colhido sem agrot√≥xicos.", preco: 20.50, img: "https://images.unsplash.com/photo-1510626176961-4f60e6a81b3b?auto=format&fit=crop&w=400&q=80" },
    { id: 3, nome: "Queijo Minas", descricao: "Queijo artesanal t√≠pico de Minas Gerais.", preco: 18.75, img: "https://images.unsplash.com/photo-1563245373-f99d0b9e0e7d?auto=format&fit=crop&w=400&q=80" },
    { id: 4, nome: "Verduras Frescas", descricao: "Alface, couve e r√∫cula fresquinhas.", preco: 5.00, img: "https://images.unsplash.com/photo-1501004318641-b39e6451bec6?auto=format&fit=crop&w=400&q=80" },
    { id: 5, nome: "Gr√£os Integrais", descricao: "Arroz, feij√£o e milho selecionados.", preco: 12.99, img: "https://images.unsplash.com/photo-1605902711622-cfb43c443f9f?auto=format&fit=crop&w=400&q=80" },
    { id: 6, nome: "Frutas da Esta√ß√£o", descricao: "Banana, ma√ß√£ e laranja direto do pomar.", preco: 7.30, img: "https://images.unsplash.com/photo-1506806732259-39c2d0268443?auto=format&fit=crop&w=400&q=80" }
  ];

  // Refer√™ncias DOM
  const lojaGrid = document.querySelector('.loja-grid');
  const listaCarrinho = document.getElementById('lista-carrinho');
  const btnEsvaziar = document.getElementById('btn-esvaziar');
  const btnContraste = document.getElementById('btn-contraste');
  const btnFonte = document.getElementById('btn-fonte');
  const btnSom = document.getElementById('btn-som');
  const btnLibras = document.getElementById('btn-libras');
  const videoLibras = document.getElementById('video-libras');
  const animacaoArvore = document.getElementById('animacao-arvore');

  // Estado do carrinho (array de objetos {id, nome, preco, quantidade})
  let carrinho = [];

  // Fun√ß√£o para renderizar produtos na loja
  function renderizarProdutos() {
    lojaGrid.innerHTML = '';
    produtos.forEach(produto => {
      const card = document.createElement('article');
      card.className = 'produto-card';
      card.setAttribute('tabindex', '0');
      card.setAttribute('aria-label', `${produto.nome} - ${produto.descricao} - pre√ßo R$${produto.preco.toFixed(2)}`);
      card.innerHTML = `
        <img src="${produto.img}" alt="${produto.nome}" loading="lazy" />
        <div class="produto-info">
          <h3>${produto.nome}</h3>
          <p>${produto.descricao}</p>
          <p class="produto-preco">R$ ${produto.preco.toFixed(2)}</p>
          <button class="btn-comprar" data-id="${produto.id}">Comprar</button>
        </div>
      `;
      lojaGrid.appendChild(card);
    });
  }

  // Adicionar produto ao carrinho
  function adicionarAoCarrinho(id) {
    const produto = produtos.find(p => p.id === id);
    if (!produto) return;
    const itemCarrinho = carrinho.find(item => item.id === id);
    if (itemCarrinho) {
      itemCarrinho.quantidade++;
    } else {
      carrinho.push({ ...produto, quantidade: 1 });
    }
    renderizarCarrinho();
  }

  // Remover produto do carrinho
  function removerDoCarrinho(id) {
    carrinho = carrinho.filter(item => item.id !== id);
    renderizarCarrinho();
  }

  // Renderizar carrinho
  function renderizarCarrinho() {
    listaCarrinho.innerHTML = '';
    if (carrinho.length === 0) {
      listaCarrinho.innerHTML = '<li>O carrinho est√° vazio.</li>';
      return;
    }
    carrinho.forEach(item => {
      const li = document.createElement('li');
      li.innerHTML = `
        <span>${item.nome} x${item.quantidade}</span>
        <button aria-label="Remover ${item.nome}" data-id="${item.id}">‚ùå</button>
      `;
      listaCarrinho.appendChild(li);
    });
  }

  // Esvaziar carrinho
  btnEsvaziar.addEventListener('click', () => {
    carrinho = [];
    renderizarCarrinho();
  });

  // Ouvir cliques no bot√£o comprar (delega√ß√£o)
  lojaGrid.addEventListener('click', e => {
    if (e.target.classList.contains('btn-comprar')) {
      const id = Number(e.target.dataset.id);
      adicionarAoCarrinho(id);
    }
  });

  // Ouvir cliques para remover item do carrinho
  listaCarrinho.addEventListener('click', e => {
    if (e.target.tagName === 'BUTTON') {
      const id = Number(e.target.dataset.id);
      removerDoCarrinho(id);
    }
  });

  // Acessibilidade: Contraste alto
  btnContraste.addEventListener('click', () => {
    document.body.classList.toggle('contraste');
  });

  // Acessibilidade: Fonte maior
  btnFonte.addEventListener('click', () => {
    document.body.classList.toggle('fonte-grande');
  });

  // Som ambiente simples
  let somAtivo = false;
  let audio;
  btnSom.addEventListener('click', () => {
    if (!somAtivo) {
      audio = new Audio('https://cdn.pixabay.com/download/audio/2021/08/04/audio_48e2cfa084.mp3?filename=relaxing-nature-sounds-forest-birds-7625.mp3');
      audio.loop = true;
      audio.volume = 0.25;
      audio.play();
      somAtivo = true;
      btnSom.textContent = "üîä";
    } else {
      audio.pause();
      somAtivo = false;
      btnSom.textContent = "üîà";
    }
  });

  // LIBRAS toggle
  btnLibras.addEventListener('click', () => {
    if (videoLibras.style.display === 'block') {
      videoLibras.style.display = 'none';
      videoLibras.setAttribute('aria-hidden', 'true');
    } else {
      videoLibras.style.display = 'block';
      videoLibras.setAttribute('aria-hidden', 'false');
    }
  });

  // Anima√ß√£o da √°rvore crescendo (3 segundos) e desaparecendo
  window.addEventListener('load', () => {
    setTimeout(() => {
      animacaoArvore.style.transition = 'opacity 1.5s ease';
      animacaoArvore.style.opacity = 0;
      setTimeout(() => {
        animacaoArvore.style.display = 'none';
      }, 1500);
    }, 3000);
  });

  // Inicializa a loja e o carrinho
  renderizarProdutos();
  renderizarCarrinho();

</script>

</body>
</html>
