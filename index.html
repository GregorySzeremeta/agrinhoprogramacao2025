<!DOCTYPE html>
<html lang="pt-br">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>EstaÃ§Ã£o da Terra</title>
  <link rel="stylesheet" href="style.css" />
  <!-- VLibras - Libras -->
  <script src="https://vlibras.gov.br/app/vlibras-plugin.js"></script>
</head>
<body>
  <!-- VLibras Widget -->
  <div vw class="enabled">
    <div vw-access-button class="active"></div>
    <div vw-plugin-wrapper>
      <div class="vw-plugin-top-wrapper"></div>
    </div>
  </div>

  <header>
    <h1>EstaÃ§Ã£o da Terra</h1>
    <p class="slogan">Do campo Ã  cidade, colhendo oportunidades</p>
    <nav>
      <button onclick="mostrarPagina('loja')">Loja</button>
      <button onclick="mostrarPagina('quiz')">Quiz</button>
      <button onclick="mostrarPagina('contato')">Contato</button>
      <div id="cart-icon" tabindex="0" aria-label="Abrir carrinho de compras" onclick="mostrarCarrinho()" onkeypress="if(event.key==='Enter'){mostrarCarrinho()}">
        ðŸ›’ <span id="cart-count">0</span>
      </div>
    </nav>
  </header>

  <main>
    <!-- Loja -->
    <section id="loja" class="pagina" aria-label="Loja">
      <div class="categoria-produtos" id="categoria-leite"></div>
      <div class="categoria-produtos" id="categoria-frutas"></div>
      <div class="categoria-produtos" id="categoria-mel"></div>
      <div class="categoria-produtos" id="categoria-queijos"></div>
      <div class="categoria-produtos" id="categoria-verduras"></div>
      <div class="categoria-produtos" id="categoria-graos"></div>
      <div class="categoria-produtos" id="categoria-plante"></div>
    </section>

    <!-- Quiz -->
    <section id="quiz" class="pagina" aria-label="Quiz interativo" hidden>
      <form id="form-quiz" aria-live="polite" aria-atomic="true">
        <!-- Perguntas serÃ£o inseridas dinamicamente -->
      </form>
      <div id="resultado" aria-live="polite" aria-atomic="true"></div>
    </section>

    <!-- Contato -->
    <section id="contato" class="pagina" aria-label="FormulÃ¡rio de contato" hidden>
      <form id="form-contato" novalidate>
        <label for="nome">Nome:</label>
        <input type="text" id="nome" name="nome" required aria-required="true" />

        <label for="email">Email:</label>
        <input type="email" id="email" name="email" required aria-required="true" />

        <label for="mensagem">Mensagem:</label>
        <textarea id="mensagem" name="mensagem" rows="4" required aria-required="true"></textarea>

        <button type="submit">Enviar</button>
      </form>
      <p id="contato-msg" role="alert"></p>
    </section>

    <!-- Carrinho modal -->
    <dialog id="modal-carrinho" aria-label="Carrinho de compras">
      <h2>Carrinho de Compras</h2>
      <ul id="carrinho-lista" tabindex="0"></ul>
      <p class="total" id="total"></p>
      <button onclick="esvaziarCarrinho()" aria-label="Esvaziar carrinho">Esvaziar</button>
      <button onclick="finalizarCompra()" aria-label="Finalizar compra">Finalizar Compra</button>
      <button onclick="fecharCarrinho()" aria-label="Fechar carrinho">Fechar</button>
    </dialog>
  </main>

  <script>
    // InicializaÃ§Ã£o do VLibras
    new window.VLibras.Widget('https://vlibras.gov.br/app');

    // Produtos - Exemplo simples
    const produtos = {
      leite: [
        {id: 'leite1', nome: 'Leite Integral', preco: 5.5, img: 'https://via.placeholder.com/180?text=Leite+Integral'},
        {id: 'leite2', nome: 'Leite Desnatado', preco: 5.0, img: 'https://via.placeholder.com/180?text=Leite+Desnatado'}
      ],
      frutas: [
        {id: 'fruta1', nome: 'MaÃ§Ã£', preco: 3.5, img: 'https://via.placeholder.com/180?text=MaÃ§Ã£'},
        {id: 'fruta2', nome: 'Banana', preco: 2.9, img: 'https://via.placeholder.com/180?text=Banana'}
      ],
      mel: [
        {id: 'mel1', nome: 'Mel Silvestre', preco: 15.0, img: 'https://via.placeholder.com/180?text=Mel+Silvestre'}
      ],
      queijos: [
        {id: 'queijo1', nome: 'Queijo Minas', preco: 20.0, img: 'https://via.placeholder.com/180?text=Queijo+Minas'}
      ],
      verduras: [
        {id: 'verdura1', nome: 'Alface', preco: 1.5, img: 'https://via.placeholder.com/180?text=Alface'}
      ],
      graos: [
        {id: 'grao1', nome: 'FeijÃ£o', preco: 7.0, img: 'https://via.placeholder.com/180?text=FeijÃ£o'}
      ],
      plante: [
        {id: 'semente1', nome: 'Sementes de Girassol', preco: 3.0, img: 'https://via.placeholder.com/180?text=Sementes+Girassol'}
      ]
    };

    // Carrinho
    let carrinho = [];

    // FunÃ§Ã£o para mostrar pÃ¡ginas
    function mostrarPagina(pagina) {
      document.querySelectorAll('.pagina').forEach(sec => {
        sec.hidden = true;
      });
      const sec = document.getElementById(pagina);
      if(sec) {
        sec.hidden = false;
        if(pagina === 'quiz') {
          animarQuiz();
        }
      }
    }

    // Gerar produtos na loja
    function gerarProdutos() {
      for (const categoria in produtos) {
        const container = document.getElementById('categoria-' + categoria);
        container.innerHTML = `<h3>${categoria.charAt(0).toUpperCase() + categoria.slice(1)}</h3><div class="grid-produtos"></div>`;
        const grid = container.querySelector('.grid-produtos');
        produtos[categoria].forEach(prod => {
          const prodDiv = document.createElement('div');
          prodDiv.className = 'produto';
          prodDiv.tabIndex = 0;
          prodDiv.innerHTML = `
            <img src="${prod.img}" alt="${prod.nome}" />
            <h4>${prod.nome}</h4>
            <p>R$ ${prod.preco.toFixed(2)}</p>
            <button onclick="adicionarAoCarrinho('${prod.id}')">Adicionar</button>
          `;
          grid.appendChild(prodDiv);
        });
      }
    }

    // Adicionar produto ao carrinho
    function adicionarAoCarrinho(id) {
      const prod = Object.values(produtos).flat().find(p => p.id === id);
      if(prod) {
        carrinho.push(prod);
        atualizarContadorCarrinho();
        alert(`${prod.nome} adicionado ao carrinho!`);
      }
    }

    // Atualizar contador no Ã­cone do carrinho
    function atualizarContadorCarrinho() {
      document.getElementById('cart-count').textContent = carrinho.length;
    }

    // Mostrar carrinho
    function mostrarCarrinho() {
      const modal = document.getElementById('modal-carrinho');
      const lista = document.getElementById('carrinho-lista');
      const totalEl = document.getElementById('total');
      lista.innerHTML = '';
      let total = 0;
      if(carrinho.length === 0) {
        lista.innerHTML = '<li>O carrinho estÃ¡ vazio.</li>';
        totalEl.textContent = '';
      } else {
        carrinho.forEach((item, i) => {
          total += item.preco;
          const li = document.createElement('li');
          li.textContent = `${item.nome} - R$ ${item.preco.toFixed(2)}`;
          const btnRemover = document.createElement('button');
          btnRemover.textContent = 'Remover';
          btnRemover.className = 'btn-remover';
          btnRemover.setAttribute('aria-label', `Remover ${item.nome} do carrinho`);
          btnRemover.onclick = () => {
            carrinho.splice(i,1);
            mostrarCarrinho();
            atualizarContadorCarrinho();
          };
          li.appendChild(btnRemover);
          lista.appendChild(li);
        });
        totalEl.textContent = `Total: R$ ${total.toFixed(2)}`;
      }
      modal.showModal();
    }

    // Fechar carrinho
    function fecharCarrinho() {
      document.getElementById('modal-carrinho').close();
    }

    // Esvaziar carrinho
    function esvaziarCarrinho() {
      carrinho = [];
      mostrarCarrinho();
      atualizarContadorCarrinho();
    }

    // Finalizar compra (simulado)
    function finalizarCompra() {
      if(carrinho.length === 0){
        alert('Carrinho vazio!');
        return;
      }
      alert('Compra finalizada com sucesso! Obrigado.');
      esvaziarCarrinho();
      fecharCarrinho();
    }

    // Quiz - perguntas e respostas
    const quizPerguntas = [
      {
        pergunta: "Qual Ã© a capital do Brasil?",
        opcoes: ["SÃ£o Paulo", "BrasÃ­lia", "Rio de Janeiro", "Salvador"],
        correta: 1
      },
      {
        pergunta: "Qual fruto Ã© conhecido como 'maÃ§Ã£ do paraÃ­so'?",
        opcoes: ["MaÃ§Ã£", "Pera", "Tomate", "Abacate"],
        correta: 2
      },
      {
        pergunta: "Qual Ã© o processo que as plantas usam para produzir alimento?",
        opcoes: ["RespiraÃ§Ã£o", "FotossÃ­ntese", "TranspiraÃ§Ã£o", "FermentaÃ§Ã£o"],
        correta: 1
      },
      {
        pergunta: "Qual Ã© o maior animal terrestre?",
        opcoes: ["Elefante", "Girafa", "Rinoceronte", "HipopÃ³tamo"],
        correta: 0
      }
    ];

    // Gerar quiz no formulÃ¡rio
    function gerarQuiz() {
      const formQuiz = document.getElementById('form-quiz');
      formQuiz.innerHTML = '';
      quizPerguntas.forEach((q, i) => {
        const fieldset = document.createElement('fieldset');
        fieldset.className = 'quiz-pergunta';
        fieldset.style.opacity = '0'; // para animar depois
        const legend = document.createElement('legend');
        legend.textContent = `${i + 1}. ${q.pergunta}`;
        fieldset.appendChild(legend);

        q.opcoes.forEach((opcao, j) => {
          const label = document.createElement('label');
          label.innerHTML = `
            <input type="radio" name="pergunta${i}" value="${j}" required />
            ${opcao}
          `;
          fieldset.appendChild(label);
        });

        formQuiz.appendChild(fieldset);
      });

      const btnSubmit = document.createElement('button');
      btnSubmit.type = 'submit';
      btnSubmit.textContent = 'Enviar Respostas';
      formQuiz.appendChild(btnSubmit);

      formQuiz.addEventListener('submit', function(event){
        event.preventDefault();
        calcularResultado();
      });
    }

    // AnimaÃ§Ã£o do quiz - fade in sequÃªncia das perguntas
    function animarQuiz() {
      const perguntas = document.querySelectorAll('.quiz-pergunta');
      perguntas.forEach((el, i) => {
        el.style.opacity = '0';
        el.style.transform = 'translateY(20px)';
        setTimeout(() => {
          el.style.transition = 'opacity 0.5s ease, transform 0.5s ease';
          el.style.opacity = '1';
          el.style.transform = 'translateY(0)';
        }, i * 300);
      });
    }

    // Calcular resultado do quiz
    function calcularResultado() {
      let pontos = 0;
      let respondidas = 0;
      const form = document.getElementById('form-quiz');
      quizPerguntas.forEach((q, i) => {
        const resposta = form[`pergunta${i}`].value;
        if(resposta !== '') {
          respondidas++;
          if(parseInt(resposta,10) === q.correta) pontos++;
        }
      });

      const resultadoEl = document.getElementById('resultado');
      if(respondidas < quizPerguntas.length) {
        resultadoEl.textContent = 'Por favor, responda todas as perguntas.';
        return;
      }

      resultadoEl.textContent = `VocÃª acertou ${pontos} de ${quizPerguntas.length} perguntas!`;
    }

    // FormulÃ¡rio contato
    document.getElementById('form-contato').addEventListener('submit', function(e){
      e.preventDefault();
      const nome = this.nome.value.trim();
      const email = this.email.value.trim();
      const mensagem = this.mensagem.value.trim();

      if(nome && email && mensagem){
        document.getElementById('contato-msg').textContent = `Obrigado, ${nome}! Sua mensagem foi enviada.`;
        this.reset();
      } else {
        document.getElementById('contato-msg').textContent = 'Por favor, preencha todos os campos.';
      }
    });

    // InicializaÃ§Ã£o
    window.onload = () => {
      gerarProdutos();
      gerarQuiz();
      mostrarPagina('loja');
      atualizarContadorCarrinho();
    };
  </script>
</body>
</html>
