<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Esta√ß√£o da Terra</title>
  <link rel="stylesheet" href="style.css" />
</head>
<body>

<header>
  <h1 tabindex="0">Esta√ß√£o da Terra</h1>
  <p class="slogan">Do campo √† cidade, colhendo oportunidades</p>
  <nav aria-label="Menu principal">
    <button class="btn-verde" onclick="mostrarPagina('loja')" aria-controls="loja" aria-expanded="true">Loja</button>
    <button class="btn-verde" onclick="mostrarPagina('quiz')" aria-controls="quiz" aria-expanded="false">Quiz</button>
    <button class="btn-verde" onclick="mostrarPagina('sobre')" aria-controls="sobre" aria-expanded="false">Sobre</button>
    <button class="btn-verde" onclick="mostrarPagina('contato')" aria-controls="contato" aria-expanded="false">Contato</button>
    <button class="btn-verde" onclick="toggleSomAmbiente()" aria-pressed="false" id="btnSom">Som do Campo üê¶</button>
    <div id="cart-icon" role="button" aria-label="Mostrar carrinho de compras" tabindex="0" onclick="mostrarCarrinho()">
      üõí<span id="cart-count" aria-live="polite" aria-atomic="true">0</span>
    </div>
  </nav>
</header>

<main>
  <!-- LOJA -->
  <section id="loja" class="pagina" role="region" aria-label="Loja de produtos">
    <div class="feira-grid" id="lista-produtos" tabindex="0" aria-live="polite">
      <!-- Produtos gerados via JS -->
    </div>
  </section>

  <!-- QUIZ -->
  <section id="quiz" class="pagina" role="region" aria-label="Quiz sobre produ√ß√£o do campo" hidden>
    <h2 tabindex="0">Quiz: Produ√ß√£o do Campo</h2>
    <form id="quiz-form" aria-describedby="quiz-instrucao">
      <p id="quiz-instrucao">Responda √†s perguntas abaixo e veja sua pontua√ß√£o.</p>
      <!-- Perguntas geradas via JS -->
      <button type="submit" class="btn-verde">Enviar Respostas</button>
    </form>
    <div id="resultado" aria-live="polite" tabindex="0"></div>
  </section>

  <!-- SOBRE -->
  <section id="sobre" class="pagina" role="region" aria-label="Sobre Esta√ß√£o da Terra" hidden tabindex="0">
    <h2>Sobre a Esta√ß√£o da Terra</h2>
    <p>Somos uma feira virtual que conecta produtores e consumidores, valorizando a sustentabilidade, a agricultura familiar e o com√©rcio justo. Nosso objetivo √© levar o melhor do campo at√© voc√™ com transpar√™ncia e qualidade.</p>
    <button class="btn-verde" onclick="mostrarPagina('loja')">Voltar √† Loja</button>
  </section>

  <!-- CONTATO -->
  <section id="contato" class="pagina" role="region" aria-label="Formul√°rio de contato" hidden>
    <h2 tabindex="0">Entre em Contato</h2>
    <form id="form-contato" aria-describedby="contato-instrucao">
      <p id="contato-instrucao">Preencha seus dados e envie sua mensagem.</p>
      <label for="nome">Nome:</label>
      <input type="text" id="nome" name="nome" required />

      <label for="email">E-mail:</label>
      <input type="email" id="email" name="email" required />

      <label for="mensagem">Mensagem:</label>
      <textarea id="mensagem" name="mensagem" rows="4" required></textarea>

      <button type="submit" class="btn-verde">Enviar</button>
    </form>
    <div id="contato-msg" aria-live="polite" tabindex="0"></div>
  </section>

  <!-- CARRINHO -->
  <section id="carrinho" class="pagina" role="region" aria-label="Carrinho de Compras" hidden>
    <h2 tabindex="0">Carrinho de Compras</h2>
    <ul id="carrinho-lista" tabindex="0"></ul>
    <p class="total" id="total" tabindex="0">Total: R$ 0,00</p>
    <button class="btn-verde" onclick="esvaziarCarrinho()">Esvaziar Carrinho</button>
    <button class="btn-verde" onclick="finalizarCompra()">Finalizar Compra</button>
    <button class="btn-verde" onclick="mostrarPagina('loja')">Voltar √† Loja</button>
  </section>

  <!-- Anima√ß√£o plantar √°rvore -->
  <div id="animar-arvore" aria-hidden="true"></div>

  <!-- Bot√µes de acessibilidade -->
  <div class="acessibilidade" role="region" aria-label="Ferramentas de acessibilidade">
    <button class="btn-acess" onclick="toggleContraste()" aria-pressed="false" id="btnContraste" title="Alternar alto contraste">Alto Contraste</button>
    <button class="btn-acess" onclick="aumentarFonte()" title="Aumentar fonte">A+</button>
    <button class="btn-acess" onclick="diminuirFonte()" title="Diminuir fonte">A-</button>
  </div>

  <!-- VLibras -->
  <div vw class="enabled">
    <div vw-access-button class="active"></div>
    <div vw-plugin-wrapper>
      <div class="vw-plugin-top-wrapper"></div>
    </div>
  </div>
  <script src="https://vlibras.gov.br/app/vlibras-plugin.js"></script>
  <script>
    new window.VLibras.Widget('https://vlibras.gov.br/app');
  </script>

  <!-- Som ambiente p√°ssaros -->
  <audio id="som-ambiente" loop>
    <source src="https://cdn.pixabay.com/download/audio/2022/03/30/audio_34648f97d0.mp3?filename=birds-10226.mp3" type="audio/mpeg" />
  </audio>

<script>
  // Produtos
  const produtos = [
    { nome: "Mel Org√¢nico", preco: 25, categoria: "Mel", imagem: "https://via.placeholder.com/200?text=Mel" },
    { nome: "Queijo Artesanal", preco: 40, categoria: "Queijo e Derivados", imagem: "https://via.placeholder.com/200?text=Queijo" },
    { nome: "Leite Integral", preco: 6, categoria: "Leite", imagem: "https://via.placeholder.com/200?text=Leite" },
    { nome: "Alface Hidrop√¥nica", preco: 4, categoria: "Verduras", imagem: "https://via.placeholder.com/200?text=Alface" },
    { nome: "Tomate Org√¢nico", preco: 8, categoria: "Frutas", imagem: "https://via.placeholder.com/200?text=Tomate" },
    { nome: "Morango Fresco", preco: 10, categoria: "Frutas", imagem: "https://via.placeholder.com/200?text=Morango" },
    { nome: "Ovos Caipira", preco: 12, categoria: "Outros", imagem: "https://via.placeholder.com/200?text=Ovos" },
    { nome: "Arroz Integral", preco: 18, categoria: "Gr√£os", imagem: "https://via.placeholder.com/200?text=Arroz" },
    { nome: "Feij√£o Preto", preco: 14, categoria: "Gr√£os", imagem: "https://via.placeholder.com/200?text=Feijao" },
    { nome: "Batata Doce", preco: 5, categoria: "Verduras", imagem: "https://via.placeholder.com/200?text=Batata" },
    { nome: "Sementes de Girassol", preco: 7, categoria: "Plante", imagem: "https://via.placeholder.com/200?text=Sementes" },
    { nome: "Ab√≥bora Org√¢nica", preco: 9, categoria: "Verduras", imagem: "https://via.placeholder.com/200?text=Abobora" },
    { nome: "Cenoura Fresca", preco: 6, categoria: "Verduras", imagem: "https://via.placeholder.com/200?text=Cenoura" },
    { nome: "Uva Org√¢nica", preco: 15, categoria: "Frutas", imagem: "https://via.placeholder.com/200?text=Uva" },
    { nome: "Farinha de Trigo", preco: 12, categoria: "Gr√£os", imagem: "https://via.placeholder.com/200?text=Farinha" },
    { nome: "Ch√° de Ervas", preco: 8, categoria: "Outros", imagem: "https://via.placeholder.com/200?text=Cha" }
  ];

  // Estado do carrinho
  let carrinho = [];

  // Fun√ß√£o para mostrar uma p√°gina e esconder as outras
  function mostrarPagina(id) {
    document.querySelectorAll('.pagina').forEach(sec => {
      if(sec.id === id){
        sec.hidden = false;
        // Ajustar aria-expanded dos bot√µes do menu
        document.querySelectorAll('nav button').forEach(btn => {
          btn.setAttribute('aria-expanded', btn.textContent.toLowerCase().includes(id) ? "true" : "false");
        });
        // Focar na se√ß√£o aberta para acessibilidade
        sec.focus();
      } else {
        sec.hidden = true;
      }
    });
  }

  // Gerar produtos na p√°gina loja
  function gerarProdutos(){
    const lista = document.getElementById('lista-produtos');
    lista.innerHTML = '';

    // Agrupar produtos por categoria
    const categorias = {};
    produtos.forEach(p => {
      if(!categorias[p.categoria]) categorias[p.categoria] = [];
      categorias[p.categoria].push(p);
    });

    for(const cat in categorias){
      const secaoCat = document.createElement('section');
      secaoCat.className = 'categoria-produtos';
      secaoCat.setAttribute('aria-label', `Categoria ${cat}`);
      const titulo = document.createElement('h3');
      titulo.textContent = cat;
      secaoCat.appendChild(titulo);

      const grid = document.createElement('div');
      grid.className = 'grid-produtos';

      categorias[cat].forEach((prod, i) => {
        const card = document.createElement('article');
        card.className = 'produto';
        card.tabIndex = 0;
        card.innerHTML = `
          <img src="${prod.imagem}" alt="${prod.nome}" />
          <h4>${prod.nome}</h4>
          <p>R$ ${prod.preco.toFixed(2)}</p>
          <button class="btn-verde" onclick="adicionarAoCarrinho(${produtos.indexOf(prod)})">Adicionar ao Carrinho</button>
        `;
        grid.appendChild(card);
      });
      secaoCat.appendChild(grid);
      lista.appendChild(secaoCat);
    }
  }

  // Adicionar ao carrinho
  function adicionarAoCarrinho(indice){
    carrinho.push(produtos[indice]);
    atualizarCarrinho();
    alert(`Produto "${produtos[indice].nome}" adicionado ao carrinho!`);
  }

  // Atualizar carrinho
  function atualizarCarrinho(){
    const count = document.getElementById('cart-count');
    count.textContent = carrinho.length;

    const listaCarrinho = document.getElementById('carrinho-lista');
    listaCarrinho.innerHTML = '';

    let total = 0;
    carrinho.forEach((item, i) => {
      total += item.preco;
      const li = document.createElement('li');
      li.textContent = `${item.nome} - R$ ${item.preco.toFixed(2)}`;
      // Bot√£o remover item do carrinho
      const btnRemover = document.createElement('button');
      btnRemover.textContent = 'Remover';
      btnRemover.className = 'btn-remover';
      btnRemover.setAttribute('aria-label', `Remover ${item.nome} do carrinho`);
      btnRemover.onclick = () => {
        carrinho.splice(i, 1);
        atualizarCarrinho();
      };
      li.appendChild(btnRemover);
      listaCarrinho.appendChild(li);
    });

    document.getElementById('total').textContent = `Total: R$ ${total.toFixed(2)}`;
  }

  // Mostrar carrinho
  function mostrarCarrinho(){
    mostrarPagina('carrinho');
    atualizarCarrinho();
  }

  // Esvaziar carrinho
  function esvaziarCarrinho(){
    if(confirm('Deseja esvaziar todo o carrinho?')){
      carrinho = [];
      atualizarCarrinho();
      mostrarPagina('loja');
    }
  }

  // Finalizar compra (simula√ß√£o)
  function finalizarCompra(){
    if(carrinho.length === 0){
      alert('Seu carrinho est√° vazio!');
      mostrarPagina('loja');
      return;
    }
    alert('Compra finalizada com sucesso! Obrigado pela prefer√™ncia.');
    carrinho = [];
    atualizarCarrinho();
    mostrarPagina('loja');
  }

  // Quiz perguntas
  const perguntasQuiz = [
    {
      pergunta: "Qual √© o melhor hor√°rio para colher alface?",
      opcoes: ["Manh√£", "Tarde", "Meia-noite"],
      correta: 0
    },
    {
      pergunta: "Quanto tempo demora para produzir mel?",
      opcoes: ["2 dias", "1 m√™s", "6 meses"],
      correta: 2
    },
    {
      pergunta: "Qual o principal nutriente do leite integral?",
      opcoes: ["Prote√≠nas", "Carboidratos", "Gorduras"],
      correta: 0
    },
    {
      pergunta: "Qual √© a fruta mais cultivada no Brasil?",
      opcoes: ["Banana", "Ma√ß√£", "Laranja"],
      correta: 2
    },
    {
      pergunta: "O que √© agricultura sustent√°vel?",
      opcoes: ["Uso excessivo de agrot√≥xicos", "Preserva√ß√£o do meio ambiente", "Desmatamento"],
      correta: 1
    },
    {
      pergunta: "Qual produto vem da categoria 'Plante'?",
      opcoes: ["Sementes de Girassol", "Queijo Artesanal", "Batata Doce"],
      correta: 0
    }
  ];

  // Gerar quiz
  function gerarQuiz(){
    const form = document.getElementById('quiz-form');
    form.innerHTML = '';

    perguntasQuiz.forEach((q, i) => {
      const fieldset = document.createElement('fieldset');
      fieldset.className = 'quiz-pergunta';

      const legend = document.createElement('legend');
      legend.textContent = `${i + 1}. ${q.pergunta}`;
      fieldset.appendChild(legend);

      // Embaralhar op√ß√µes
      let opcoesEmbaralhadas = q.opcoes
        .map((op, idx) => ({op, idx}))
        .sort(() => Math.random() - 0.5);

      opcoesEmbaralhadas.forEach(({op, idx}) => {
        const label = document.createElement('label');
        label.innerHTML = `
          <input type="radio" name="q${i}" value="${idx}" required /> ${op}
        `;
        fieldset.appendChild(label);
      });

      form.insertBefore(fieldset, form.querySelector('button'));
    });
  }

  // Avaliar quiz
  document.getElementById('quiz-form').addEventListener('submit', function(event){
    event.preventDefault();
    let pontos = 0;

    perguntasQuiz.forEach((q, i) => {
      const resposta = this[`q${i}`].value;
      if(resposta == q.correta) pontos++;
    });

    const total = perguntasQuiz.length;
    const resultado = document.getElementById('resultado');
    resultado.textContent = `Voc√™ acertou ${pontos} de ${total} perguntas! (${Math.round((pontos/total)*100)}%)`;
    resultado.focus();
  });

  // Controle som ambiente
  function toggleSomAmbiente(){
    const audio = document.getElementById('som-ambiente');
    const btn = document.getElementById('btnSom');
    if(audio.paused){
      audio.play();
      btn.setAttribute('aria-pressed', 'true');
      btn.textContent = 'Som do Campo üê¶ (Ligado)';
    } else {
      audio.pause();
      btn.setAttribute('aria-pressed', 'false');
      btn.textContent = 'Som do Campo üê¶ (Desligado)';
    }
  }

  // Acessibilidade: contraste alto
  let contrasteAtivo = false;
  function toggleContraste(){
    contrasteAtivo = !contrasteAtivo;
    document.body.classList.toggle('alto-contraste', contrasteAtivo);
    document.getElementById('btnContraste').setAttribute('aria-pressed', contrasteAtivo);
  }

  // Acessibilidade: aumentar fonte
  function aumentarFonte(){
    const body = document.body;
    const style = window.getComputedStyle(body).fontSize;
    let tamanho = parseFloat(style);
    if(tamanho < 24) body.style.fontSize = (tamanho + 2) + "px";
  }

  // Acessibilidade: diminuir fonte
  function diminuirFonte(){
    const body = document.body;
    const style = window.getComputedStyle(body).fontSize;
    let tamanho = parseFloat(style);
    if(tamanho > 12) body.style.fontSize = (tamanho - 2) + "px";
  }

  // Anima√ß√£o plantar √°rvore
  function animarArvore(){
    const container = document.getElementById('animar-arvore');
    container.innerHTML = ''; // reset

    // Cria um "tronco" e "folhas" com anima√ß√£o simples
    const tronco = document.createElement('div');
    tronco.className = 'tronco';
    container.appendChild(tronco);

    const folhas = document.createElement('div');
    folhas.className = 'folhas';
    container.appendChild(folhas);

    // Anima√ß√µes via CSS (no style.css)
  }

  // Inicializa√ß√µes
  window.onload = () => {
    gerarProdutos();
    gerarQuiz();
    animarArvore();
    mostrarPagina('loja');
  };

  // Formul√°rio contato
  document.getElementById('form-contato').addEventListener('submit', function(e){
    e.preventDefault();
    const nome = this.nome.value.trim();
    const email = this.email.value.trim();
    const mensagem = this.mensagem.value.trim();

    if(nome && email && mensagem){
      document.getElementById('contato-msg').textContent = `Obrigado, ${nome}! Sua mensagem foi enviada.`;
      this.reset();
    } else {
      document.getElementById('contato-msg').textContent = 'Por favor, preencha todos os campos.';
    }
  });
</script>

</body>
</html>
