<!DOCTYPE html>
<html lang="pt-br">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Estação da Terra</title>
  <link rel="stylesheet" href="style.css" />
  <!-- VLibras script -->
  <script src="https://vlibras.gov.br/app/vlibras-plugin.js"></script>
</head>
<body>

  <!-- VLibras -->
  <div vw class="enabled">
    <div vw-access-button class="active"></div>
    <div vw-plugin-wrapper>
      <div class="vw-plugin-top-wrapper"></div>
    </div>
  </div>

  <!-- Cabeçalho -->
  <header>
    <h1>Estação da Terra</h1>
    <p class="slogan">Do campo à cidade, colhendo oportunidades</p>
    <nav class="menu">
      <ul>
        <li><a href="quiz.html">Quiz</a></li>
        <li><a href="sobre.html">Sobre</a></li>
      </ul>
    </nav>
  </header>

  <!-- Produtos -->
  <main>
    <section class="produtos">
      <h2>Produtos à Venda</h2>
      <div class="barracas">

        <!-- Produtos originais -->
        <div class="produto-card">
          <img src="img/maçã.jpg" alt="Maçã Orgânica" />
          <h3>Maçã Orgânica</h3>
          <p>R$ 3,00/kg</p>
          <button onclick="adicionarAoCarrinho('Maçã Orgânica', 3)">Adicionar</button>
        </div>
        <div class="produto-card">
          <img src="img/mel.jpg" alt="Mel Puro" />
          <h3>Mel Puro</h3>
          <p>R$ 15,00</p>
          <button onclick="adicionarAoCarrinho('Mel Puro', 15)">Adicionar</button>
        </div>
        <div class="produto-card">
          <img src="img/queijo.jpg" alt="Queijo Artesanal" />
          <h3>Queijo Artesanal</h3>
          <p>R$ 25,00</p>
          <button onclick="adicionarAoCarrinho('Queijo Artesanal', 25)">Adicionar</button>
        </div>

        <!-- Novos produtos -->
        <div class="produto-card">
          <img src="img/banana.jpg" alt="Banana" />
          <h3>Banana</h3>
          <p>R$ 2,50/kg</p>
          <button onclick="adicionarAoCarrinho('Banana', 2.5)">Adicionar</button>
        </div>
        <div class="produto-card">
          <img src="img/tomate.jpg" alt="Tomate" />
          <h3>Tomate</h3>
          <p>R$ 4,00/kg</p>
          <button onclick="adicionarAoCarrinho('Tomate', 4)">Adicionar</button>
        </div>
        <div class="produto-card">
          <img src="img/alface.jpg" alt="Alface" />
          <h3>Alface</h3>
          <p>R$ 1,80/un</p>
          <button onclick="adicionarAoCarrinho('Alface', 1.8)">Adicionar</button>
        </div>
        <div class="produto-card">
          <img src="img/cenoura.jpg" alt="Cenoura" />
          <h3>Cenoura</h3>
          <p>R$ 3,20/kg</p>
          <button onclick="adicionarAoCarrinho('Cenoura', 3.2)">Adicionar</button>
        </div>
        <div class="produto-card">
          <img src="img/batata.jpg" alt="Batata" />
          <h3>Batata</h3>
          <p>R$ 2,90/kg</p>
          <button onclick="adicionarAoCarrinho('Batata', 2.9)">Adicionar</button>
        </div>
        <div class="produto-card">
          <img src="img/abacate.jpg" alt="Abacate" />
          <h3>Abacate</h3>
          <p>R$ 7,00/un</p>
          <button onclick="adicionarAoCarrinho('Abacate', 7)">Adicionar</button>
        </div>
        <div class="produto-card">
          <img src="img/Pãointegral.jpg" alt="Pão Integral" />
          <h3>Pão Integral</h3>
          <p>R$ 6,50</p>
          <button onclick="adicionarAoCarrinho('Pão Integral', 6.5)">Adicionar</button>
        </div>
        <div class="produto-card">
          <img src="img/leite.jpg" alt="Leite" />
          <h3>Leite</h3>
          <p>R$ 4,00/litro</p>
          <button onclick="adicionarAoCarrinho('Leite', 4)">Adicionar</button>
        </div>
        <div class="produto-card">
          <img src="img/ovo.jpg" alt="Ovos" />
          <h3>Ovos</h3>
          <p>R$ 8,00/12 unidades</p>
          <button onclick="adicionarAoCarrinho('Ovos', 8)">Adicionar</button>
        </div>
        <div class="produto-card">
          <img src="img/arroz.jpg" alt="Arroz Integral" />
          <h3>Arroz</h3>
          <p>R$ 5,50/kg</p>
          <button onclick="adicionarAoCarrinho('Arroz Integral', 5.5)">Adicionar</button>
        </div>
        <div class="produto-card">
          <img src="img/feijão.jpg" alt="Feijão" />
          <h3>Feijão</h3>
          <p>R$ 6,00/kg</p>
          <button onclick="adicionarAoCarrinho('Feijão', 6)">Adicionar</button>
        </div>

      </div>
    </section>

    <!-- Carrinho -->
    <section class="carrinho" aria-label="Carrinho de Compras">
      <h2>Carrinho</h2>
      <ul id="lista-carrinho" aria-live="polite" aria-relevant="additions removals"></ul>
      <p id="total-carrinho">Total: R$ 0,00</p>
      <button id="btn-finalizar" onclick="mostrarAreaPagamento()" disabled>Finalizar Compra</button>
      <button id="btn-limpar" onclick="limparCarrinho()" disabled>Limpar Carrinho</button>
    </section>

    <!-- Área de Pagamento (inicialmente oculta) -->
    <section class="pagamento" id="area-pagamento" style="display:none;">
      <h2>Pagamento</h2>
      <form id="form-pagamento" onsubmit="finalizarCompra(event)">
        <label for="nome">Nome Completo:</label>
        <input type="text" id="nome" name="nome" required />

        <label for="cartao">Número do Cartão:</label>
        <input type="text" id="cartao" name="cartao" pattern="\d{16}" maxlength="16" placeholder="0000 0000 0000 0000" required />

        <label for="validade">Validade:</label>
        <input type="month" id="validade" name="validade" required />

        <label for="cvv">CVV:</label>
        <input type="password" id="cvv" name="cvv" pattern="\d{3}" maxlength="3" required />

        <button type="submit">Pagar</button>
        <button type="button" onclick="voltarAoCarrinho()">Voltar ao Carrinho</button>
      </form>
    </section>
  </main>

  <script>
    // Dados do carrinho
    let carrinho = [];

    function adicionarAoCarrinho(nome, preco) {
      const itemExistente = carrinho.find(item => item.nome === nome);
      if (itemExistente) {
        itemExistente.quantidade++;
      } else {
        carrinho.push({ nome, preco, quantidade: 1 });
      }
      atualizarCarrinho();
    }

    function atualizarCarrinho() {
      const lista = document.getElementById('lista-carrinho');
      lista.innerHTML = '';

      let total = 0;
      carrinho.forEach((item, index) => {
        total += item.preco * item.quantidade;

        const li = document.createElement('li');
        li.textContent = `${item.nome} - R$ ${item.preco.toFixed(2)} x ${item.quantidade}`;
        
        // Botão remover item
        const btnRemover = document.createElement('button');
        btnRemover.textContent = 'Remover';
        btnRemover.setAttribute('aria-label', `Remover ${item.nome} do carrinho`);
        btnRemover.onclick = () => {
          removerDoCarrinho(index);
        };
        li.appendChild(btnRemover);
        lista.appendChild(li);
      });

      document.getElementById('total-carrinho').textContent = `Total: R$ ${total.toFixed(2)}`;

      document.getElementById('btn-finalizar').disabled = carrinho.length === 0;
      document.getElementById('btn-limpar').disabled = carrinho.length === 0;
    }

    function removerDoCarrinho(index) {
      carrinho.splice(index, 1);
      atualizarCarrinho();
    }

    function limparCarrinho() {
      if(confirm('Deseja realmente limpar o carrinho?')) {
        carrinho = [];
        atualizarCarrinho();
      }
    }

    function mostrarAreaPagamento() {
      document.querySelector('.produtos').style.display = 'none';
      document.querySelector('.carrinho').style.display = 'none';
      document.getElementById('area-pagamento').style.display = 'block';
      window.scrollTo(0,0);
    }

    function voltarAoCarrinho() {
      document.querySelector('.produtos').style.display = 'block';
      document.querySelector('.carrinho').style.display = 'block';
      document.getElementById('area-pagamento').style.display = 'none';
      window.scrollTo(0,0);
    }

    function finalizarCompra(event) {
      event.preventDefault();

      const nome = document.getElementById('nome').value.trim();
      if (carrinho.length === 0) {
        alert('Seu carrinho está vazio.');
        voltarAoCarrinho();
        return;
      }
      alert(`Obrigado pela compra, ${nome}! \nTotal: R$ ${carrinho.reduce((acc, item) => acc + item.preco * item.quantidade, 0).toFixed(2)}`);

      // Resetar tudo
      carrinho = [];
      atualizarCarrinho();
      document.getElementById('form-pagamento').reset();
      voltarAoCarrinho();
    }

    // Inicializa o carrinho vazio
    atualizarCarrinho();

    // Inicia VLibras plugin
    new window.VLibras.Widget('https://vlibras.gov.br/app');
  </script>
</body>
</html>
