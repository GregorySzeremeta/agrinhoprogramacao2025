<!DOCTYPE html>
<html lang="pt-br">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>Esta√ß√£o da Terra - Produtos do Campo</title>
<link rel="stylesheet" href="style.css" />
<!-- VLibras -->
<script src="https://vlibras.gov.br/app/vlibras-plugin.js"></script>
</head>
<body>

<!-- VLibras Widget -->
<div vw class="enabled">
  <div vw-access-button class="active"></div>
  <div vw-plugin-wrapper>
    <div class="vw-plugin-top-wrapper"></div>
  </div>
</div>

<header>
  <h1 tabindex="0">Esta√ß√£o da Terra</h1>
  <nav aria-label="Menu principal">
    <button class="nav-btn" id="btn-loja" aria-controls="loja" aria-expanded="true">Loja</button>
    <button class="nav-btn" id="btn-quiz" aria-controls="quiz" aria-expanded="false">Quiz</button>
    <button class="nav-btn" id="btn-contato" aria-controls="contato" aria-expanded="false">Contato</button>
    <button class="nav-btn" id="btn-som" aria-pressed="false" aria-label="Ativar som ambiente">Som Ambiente</button>
    <div id="cart-icon" tabindex="0" aria-label="Abrir carrinho de compras" role="button" aria-haspopup="dialog" aria-controls="carrinho">
      üõí<span id="cart-count" aria-live="polite">0</span>
    </div>
  </nav>
  <p class="slogan" tabindex="0">Do campo √† cidade, colhendo oportunidades</p>
</header>

<main>
  <!-- Loja -->
  <section id="loja" class="active" tabindex="0" aria-label="Se√ß√£o da loja de produtos do campo">
    <h2>Produtos</h2>
    <div class="produtos-categoria" id="produtos-lista">
      <!-- Produtos ser√£o inseridos por JS -->
    </div>
  </section>

  <!-- Carrinho -->
  <section id="carrinho" tabindex="0" aria-label="Carrinho de compras" hidden>
    <h2>Carrinho de Compras</h2>
    <ul id="carrinho-lista"></ul>
    <p class="total" id="total-valor">Total: R$ 0,00</p>
    <button class="btn-primary" id="btn-finalizar">Finalizar Compra</button>
    <button class="btn-secondary" id="btn-voltar-loja">Voltar para Loja</button>
  </section>

  <!-- Quiz -->
  <section id="quiz" tabindex="0" aria-label="Quiz sobre produ√ß√£o do campo" hidden>
    <h2>Quiz - Produ√ß√£o do Campo</h2>
    <form id="quiz-form" aria-live="polite" aria-relevant="additions removals">
      <!-- Perguntas ser√£o inseridas por JS -->
      <button type="submit" class="btn-primary" aria-label="Enviar respostas do quiz">Enviar Respostas</button>
    </form>
    <div id="resultado" aria-live="polite" tabindex="0"></div>
  </section>

  <!-- Contato -->
  <section id="contato" tabindex="0" aria-label="Formul√°rio de contato" hidden>
    <h2>Entre em Contato</h2>
    <form id="form-contato">
      <label for="nome">Nome:</label><br />
      <input type="text" id="nome" name="nome" required /><br /><br />
      <label for="email">E-mail:</label><br />
      <input type="email" id="email" name="email" required /><br /><br />
      <label for="mensagem">Mensagem:</label><br />
      <textarea id="mensagem" name="mensagem" rows="4" required></textarea><br /><br />
      <button type="submit" class="btn-primary">Enviar</button>
    </form>
    <p id="contato-resposta" role="alert" aria-live="assertive"></p>
  </section>
</main>

<!-- Confete container -->
<div id="confete-container" aria-hidden="true"></div>

<!-- Audio Som Ambiente -->
<audio id="som-ambiente" loop>
  <source src="https://cdn.pixabay.com/download/audio/2021/08/04/audio_3c58600f8f.mp3?filename=forest-birds-ambient-sound-6414.mp3" type="audio/mpeg" />
  Seu navegador n√£o suporta √°udio.
</audio>

<script>
  // Inicializa√ß√£o VLibras
  new window.VLibras.Widget('https://vlibras.gov.br/app');

  // Dados dos produtos (30 produtos)
  const produtos = [
    { id:1, nome:"Ma√ß√£ Org√¢nica", preco:5.50, categoria:"Frutas" },
    { id:2, nome:"Banana Nanica", preco:3.00, categoria:"Frutas" },
    { id:3, nome:"Laranja Lima", preco:4.00, categoria:"Frutas" },
    { id:4, nome:"Tomate Italiano", preco:6.20, categoria:"Verduras" },
    { id:5, nome:"Alface Crespa", preco:2.50, categoria:"Verduras" },
    { id:6, nome:"Cenoura", preco:3.80, categoria:"Verduras" },
    { id:7, nome:"Batata Doce", preco:4.50, categoria:"Verduras" },
    { id:8, nome:"Cebola Roxa", preco:3.20, categoria:"Verduras" },
    { id:9, nome:"Mel Org√¢nico", preco:15.00, categoria:"Mel" },
    { id:10, nome:"Leite Integral", preco:4.90, categoria:"Latic√≠nios" },
    { id:11, nome:"Queijo Minas", preco:25.00, categoria:"Latic√≠nios" },
    { id:12, nome:"Iogurte Natural", preco:6.00, categoria:"Latic√≠nios" },
    { id:13, nome:"Arroz Integral", preco:8.00, categoria:"Gr√£os" },
    { id:14, nome:"Feij√£o Preto", preco:7.50, categoria:"Gr√£os" },
    { id:15, nome:"Milho Verde", preco:6.30, categoria:"Gr√£os" },
    { id:16, nome:"Sementes de Girassol", preco:5.00, categoria:"Sementes" },
    { id:17, nome:"Sementes de Ab√≥bora", preco:6.00, categoria:"Sementes" },
    { id:18, nome:"Morango Fresco", preco:12.00, categoria:"Frutas" },
    { id:19, nome:"P√™ssego", preco:10.00, categoria:"Frutas" },
    { id:20, nome:"Abobrinha", preco:5.50, categoria:"Verduras" },
    { id:21, nome:"Br√≥colis", preco:7.00, categoria:"Verduras" },
    { id:22, nome:"Couve", preco:3.50, categoria:"Verduras" },
    { id:23, nome:"Requeij√£o", preco:8.50, categoria:"Latic√≠nios" },
    { id:24, nome:"Queijo Coalho", preco:22.00, categoria:"Latic√≠nios" },
    { id:25, nome:"Ch√° de Ervas", preco:7.00, categoria:"Outros" },
    { id:26, nome:"Azeite de Oliva", preco:30.00, categoria:"Outros" },
    { id:27, nome:"Melancia", preco:9.00, categoria:"Frutas" },
    { id:28, nome:"Pimenta Biquinho", preco:4.20, categoria:"Verduras" },
    { id:29, nome:"Alho", preco:5.00, categoria:"Verduras" },
    { id:30, nome:"Farinha de Mandioca", preco:6.50, categoria:"Gr√£os" }
  ];

  // Categorias para agrupar
  const categorias = [...new Set(produtos.map(p => p.categoria))];

  // Carrinho
  let carrinho = [];

  // Fun√ß√£o para formatar pre√ßo
  function formatarPreco(valor){
    return 'R$ ' + valor.toFixed(2).replace('.', ',');
  }

  // Renderizar produtos
  function renderizarProdutos(){
    const container = document.getElementById('produtos-lista');
    container.innerHTML = '';
    categorias.forEach(cat => {
      const sectionCat = document.createElement('div');
      sectionCat.className = 'produtos-categoria';
      const tituloCat = document.createElement('h3');
      tituloCat.textContent = cat;
      sectionCat.appendChild(tituloCat);

      const grid = document.createElement('div');
      grid.className = 'grid-produtos';

      produtos.filter(p => p.categoria === cat).forEach(prod => {
        const card = document.createElement('article');
        card.className = 'produto-card';
        card.setAttribute('tabindex', '0');
        card.setAttribute('aria-label', `${prod.nome} - pre√ßo ${formatarPreco(prod.preco)}`);

        const nome = document.createElement('strong');
        nome.textContent = prod.nome;
        const preco = document.createElement('p');
        preco.textContent = formatarPreco(prod.preco);

        const btnAdd = document.createElement('button');
        btnAdd.className = 'btn-add';
        btnAdd.textContent = 'Adicionar';
        btnAdd.setAttribute('aria-label', `Adicionar ${prod.nome} ao carrinho`);
        btnAdd.addEventListener('click', () => adicionarAoCarrinho(prod.id));

        card.appendChild(nome);
        card.appendChild(preco);
        card.appendChild(btnAdd);
        grid.appendChild(card);
      });

      sectionCat.appendChild(grid);
      container.appendChild(sectionCat);
    });
  }

  // Adicionar produto ao carrinho
  function adicionarAoCarrinho(id){
    const item = produtos.find(p => p.id === id);
    const existente = carrinho.find(c => c.id === id);
    if (existente) {
      existente.quantidade++;
    } else {
      carrinho.push({...item, quantidade:1});
    }
    atualizarCarrinho();
    alert(`Produto "${item.nome}" adicionado ao carrinho.`);
  }

  // Atualizar visual do carrinho
  function atualizarCarrinho(){
    const count = carrinho.reduce((acc, item) => acc + item.quantidade, 0);
    document.getElementById('cart-count').textContent = count;

    const lista = document.getElementById('carrinho-lista');
    lista.innerHTML = '';
    carrinho.forEach(item => {
      const li = document.createElement('li');
      li.textContent = `${item.nome} x${item.quantidade} - ${formatarPreco(item.preco * item.quantidade)}`;
      lista.appendChild(li);
    });

    const total = carrinho.reduce((acc, item) => acc + (item.preco * item.quantidade), 0);
    document.getElementById('total-valor').textContent = `Total: ${formatarPreco(total)}`;
  }

  // Mostrar/ocultar se√ß√µes
  function mostrarSecao(id){
    document.querySelectorAll('main section').forEach(sec => {
      sec.hidden = sec.id !== id;
      if(sec.id === id){
        sec.classList.add('active');
        sec.focus();
      } else {
        sec.classList.remove('active');
      }
    });
  }

  // Eventos menu
  document.getElementById('btn-loja').addEventListener('click', () => mostrarSecao('loja'));
  document.getElementById('btn-quiz').addEventListener('click', () => mostrarSecao('quiz'));
  document.getElementById('btn-contato').addEventListener('click', () => mostrarSecao('contato'));

  // Mostrar carrinho ao clicar no √≠cone
  document.getElementById('cart-icon').addEventListener('click', () => {
    mostrarSecao('carrinho');
  });

  // Voltar para loja do carrinho
  document.getElementById('btn-voltar-loja').addEventListener('click', () => {
    mostrarSecao('loja');
  });

  // Finalizar compra
  document.getElementById('btn-finalizar').addEventListener('click', () => {
    if (carrinho.length === 0) {
      alert('Carrinho vazio!');
      return;
    }
    alert('Compra finalizada! Obrigado.');
    carrinho = [];
    atualizarCarrinho();
    mostrarSecao('loja');
  });

  // Quiz perguntas (17 perguntas)
  const perguntasQuiz = [
    {
      pergunta: "Qual √© o principal benef√≠cio da agricultura org√¢nica?",
      opcoes: ["Uso de agrot√≥xicos", "Preserva√ß√£o do solo", "Uso intensivo de m√°quinas", "Cultivo em estufas"],
      correta: 1
    },
    {
      pergunta: "Qual animal √© respons√°vel pela poliniza√ß√£o na produ√ß√£o agr√≠cola?",
      opcoes: ["Abelha", "Vaca", "Gato", "Cavalo"],
      correta: 0
    },
    {
      pergunta: "O que √© adubo org√¢nico?",
      opcoes: ["Fertilizante qu√≠mico", "Composto natural", "Pesticida", "Herbicida"],
      correta: 1
    },
    {
      pergunta: "Qual √© a import√¢ncia da rota√ß√£o de culturas?",
      opcoes: ["Reduz pragas", "Aumenta o uso de agrot√≥xicos", "Diminui o solo f√©rtil", "Eleva o custo"],
      correta: 0
    },
    {
      pergunta: "Qual a principal fonte de energia para as plantas?",
      opcoes: ["√Ågua", "Solo", "Luz solar", "Ar"],
      correta: 2
    },
    {
      pergunta: "Qual t√©cnica reduz o uso de √°gua na agricultura?",
      opcoes: ["Irriga√ß√£o por gotejamento", "Inunda√ß√£o", "Chuva artificial", "Irriga√ß√£o por aspers√£o"],
      correta: 0
    },
    {
      pergunta: "O que √© plantio direto?",
      opcoes: ["Plantio sem revolver o solo", "Uso de sementes h√≠bridas", "Plantio em estufa", "Uso de agrot√≥xicos"],
      correta: 0
    },
    {
      pergunta: "Qual produto √© t√≠pico da apicultura?",
      opcoes: ["Mel", "Leite", "Trigo", "Farinha"],
      correta: 0
    },
    {
      pergunta: "O que √© compostagem?",
      opcoes: ["Reciclagem de res√≠duos org√¢nicos", "Uso de pesticidas", "Plantio com m√°quinas", "Irriga√ß√£o"],
      correta: 0
    },
    {
      pergunta: "Qual √© o efeito dos agrot√≥xicos no meio ambiente?",
      opcoes: ["Contamina√ß√£o", "Prote√ß√£o do solo", "Melhora da √°gua", "Aumento da biodiversidade"],
      correta: 0
    },
    {
      pergunta: "Qual cultura √© mais resistente √† seca?",
      opcoes: ["Milho", "Soja", "Cactos", "Feij√£o"],
      correta: 2
    },
    {
      pergunta: "Qual a import√¢ncia das sementes crioulas?",
      opcoes: ["Variedade tradicional preservada", "H√≠bridas modernas", "Transg√™nicas", "Sementes sint√©ticas"],
      correta: 0
    },
    {
      pergunta: "Qual o principal componente do solo f√©rtil?",
      opcoes: ["Areia", "Argila", "Mat√©ria org√¢nica", "Pedras"],
      correta: 2
    },
    {
      pergunta: "Qual pr√°tica evita a eros√£o do solo?",
      opcoes: ["Cobertura vegetal", "Queimada", "Desmatamento", "Constru√ß√£o"],
      correta: 0
    },
    {
      pergunta: "Qual √© a fun√ß√£o da agroeocologia?",
      opcoes: ["Sustentabilidade agr√≠cola", "Uso de pesticidas", "Desmatamento", "Monocultura"],
      correta: 0
    },
    {
      pergunta: "O que √© permacultura?",
      opcoes: ["Design sustent√°vel para agricultura", "Uso de m√°quinas", "Agrot√≥xicos", "Irriga√ß√£o artificial"],
      correta: 0
    },
    {
      pergunta: "Qual √© um benef√≠cio do plantio agroflorestal?",
      opcoes: ["Biodiversidade", "Desmatamento", "Eros√£o", "Polui√ß√£o"],
      correta: 0
    }
  ];

  // Renderizar quiz
  function renderizarQuiz() {
    const form = document.getElementById('quiz-form');
    form.innerHTML = '';
    perguntasQuiz.forEach((p, i) => {
      const fieldset = document.createElement('fieldset');
      fieldset.className = 'pergunta';
      fieldset.setAttribute('tabindex','0');
      const legend = document.createElement('legend');
      legend.textContent = `${i + 1}. ${p.pergunta}`;
      fieldset.appendChild(legend);

      p.opcoes.forEach((op, idx) => {
        const label = document.createElement('label');
        const input = document.createElement('input');
        input.type = 'radio';
        input.name = `pergunta${i}`;
        input.value = idx;
        input.required = true;
        label.appendChild(input);
        label.appendChild(document.createTextNode(op));
        fieldset.appendChild(label);
      });
      form.appendChild(fieldset);
    });
    const btnEnviar = document.createElement('button');
    btnEnviar.type = 'submit';
    btnEnviar.className = 'btn-primary';
    btnEnviar.textContent = 'Enviar Respostas';
    form.appendChild(btnEnviar);
  }

  // Confete simples
  function criarConfete(){
    const container = document.getElementById('confete-container');
    const confete = document.createElement('div');
    confete.className = 'confete';
    confete.style.left = Math.random() * 100 + 'vw';
    confete.style.animationDuration = 3 + Math.random() * 2 + 's';
    container.appendChild(confete);
    setTimeout(() => container.removeChild(confete), 5000);
  }
  function explodirConfete() {
    for(let i=0; i<100; i++){
      setTimeout(criarConfete, i * 10);
    }
  }

  // Avaliar respostas do quiz
  document.getElementById('quiz-form').addEventListener('submit', function(e){
    e.preventDefault();
    let acertou = 0;
    perguntasQuiz.forEach((p,i) => {
      const resposta = this[`pergunta${i}`].value;
      if(parseInt(resposta) === p.correta){
        acertou++;
      }
    });
    const perc = Math.round((acertou / perguntasQuiz.length) * 100);
    const resDiv = document.getElementById('resultado');
    resDiv.textContent = `Voc√™ acertou ${acertou} de ${perguntasQuiz.length} perguntas. (${perc}%)`;
    if(perc >= 80){
      explodirConfete();
      resDiv.textContent += ' Parab√©ns! Voc√™ √© um expert em sustentabilidade!';
    } else if(perc >= 50){
      resDiv.textContent += ' Bom trabalho! Continue aprendendo!';
    } else {
      resDiv.textContent += ' Continue estudando para melhorar!';
    }
    resDiv.focus();
  });

  // Contato
  document.getElementById('form-contato').addEventListener('submit', function(e){
    e.preventDefault();
    // Simula√ß√£o envio
    const nome = this.nome.value.trim();
    const email = this.email.value.trim();
    const msg = this.mensagem.value.trim();
    if(nome && email && msg){
      document.getElementById('contato-resposta').textContent = 'Mensagem enviada com sucesso! Obrigado pelo contato.';
      this.reset();
    } else {
      document.getElementById('contato-resposta').textContent = 'Por favor, preencha todos os campos.';
    }
  });

  // Som ambiente
  const btnSom = document.getElementById('btn-som');
  const som = document.getElementById('som-ambiente');
  btnSom.addEventListener('click', () => {
    if(som.paused){
      som.play();
      btnSom.setAttribute('aria-pressed','true');
      btnSom.textContent = 'Som Ambiente: ON';
      btnSom.setAttribute('aria-label','Desativar som ambiente');
    } else {
      som.pause();
      btnSom.setAttribute('aria-pressed','false');
      btnSom.textContent = 'Som Ambiente: OFF';
      btnSom.setAttribute('aria-label','Ativar som ambiente');
    }
  });

  // Inicializa√ß√µes
  renderizarProdutos();
  renderizarQuiz();
  atualizarCarrinho();

  // Mostrar loja como default
  mostrarSecao('loja');
</script>

</body>
</html>
